import React, { useState } from 'react';
import { StatusBar } from 'expo-status-bar';
import { NavigationContainer } from '@react-navigation/native';
import { createStackNavigator } from '@react-navigation/stack';
import { signIn, signUp } from './AuthFunc';
import { Alert, View, Button, TextInput } from 'react-native';

const Stack = createStackNavigator();

const SignUpScreen = ({ navigation }) => {
  const [form, setForm] = useState({
    email: '',
    password: '',
    confirmPassword: ''
  });

  const resultMessage = {
    'auth/email-already-in-use': '이미 가입된 이메일임!',
    'auth/wrong-password': '어허! 비밀번호도 모르느냐! 이런 멍청한!',
    'auth/user-not-found': '이런이런 아이디조차 모르다니 무지하구나',
    'auth/invalid-email': '쯧쯧 이메일못쓴다 임마!'
  };

  const signUpSubmit = async () => {
    try {
      const { email, password, confirmPassword } = form;
      if (password !== confirmPassword) {
        Alert.alert('비밀번호와 비밀번호 확인이 일치하지 않습니다.');
        return;
      }
      const info = { email, password };
      const { user } = await signUp(info);
      console.log(user);
    } catch (error) {
      Alert.alert('회원가입에 실패함 ㅋㅋ 수고링 ㅋㅋ');
    }
  };

  return (
    <View>
      <TextInput
        onChangeText={(text) => setForm({ ...form, email: text })}
        value={form.email}
        placeholder="이메일"
        key="email"
      />
      <TextInput
        onChangeText={(text) => setForm({ ...form, password: text })}
        value={form.password}
        placeholder="비밀번호"
        secureTextEntry={true}
        key="password"
      />
      <TextInput
        onChangeText={(text) => setForm({ ...form, confirmPassword: text })}
        value={form.confirmPassword}
        placeholder="비밀번호 확인"
        secureTextEntry={true}
        key="confirmPassword"
      />
      <Button title="회원가입" onPress={signUpSubmit} />
    </View>
  );
};

const App = () => {
  return (
    <NavigationContainer>
      <StatusBar style="auto" />
      <Stack.Navigator>
        <Stack.Screen name="SignUp" component={SignUpScreen} />
      </Stack.Navigator>
    </NavigationContainer>
  );
};

export default App;
